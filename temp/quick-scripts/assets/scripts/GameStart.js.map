{"version":3,"sources":["GameStart.js"],"names":["cc","Class","extends","Component","properties","btn_start","default","type","Node","btn_help","bgmAudio","url","AudioClip","onLoad","active","_addWaiting","_addResources","_onPlayAudio","node","addChild","waitingLabel","label","addComponent","Label","color","string","setPosition","self","sys","localStorage","getItem","_initData","onStartGame","director","loadScene","onHelp","_stopPlayAudio","current","audioEngine","play","stop","jsonPath","raw","loader","load","err","res","resources","setItem","JSON","stringify"],"mappings":";;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACX;AACAC,mBAAY;AACXC,qBAAU,IADC;AAEXC,kBAAOP,GAAGQ;AAFC,SAFD;AAMR;AACAC,kBAAW;AACPH,qBAAU,IADH;AAEbC,kBAAOP,GAAGQ;AAFG,SAPH;AAWR;AACN;AACG;AACG;AACA;AACAE,kBAAW;AACPC,iBAAKX,GAAGY,SADD;AAEPN,qBAAS;AAFF;AAhBH,KAHP;;AAyBL;;AAEAO,YAAS,kBAAY;AACjB;AACA,aAAKR,SAAL,CAAeS,MAAf,GAAwB,KAAxB;AACA,aAAKC,WAAL;;AAEA;AACA,aAAKC,aAAL;AACA;AACA,aAAKC,YAAL;AACH,KApCI;;AAsCLF,iBAAc,uBAAU;AACpB,YAAIG,OAAO,IAAIlB,GAAGQ,IAAP,EAAX;AACA,aAAKU,IAAL,CAAUC,QAAV,CAAmBD,IAAnB;AACA,aAAKE,YAAL,GAAoBF,IAApB;AACA,YAAIG,QAAQH,KAAKI,YAAL,CAAkBtB,GAAGuB,KAArB,CAAZ;AACAL,aAAKM,KAAL,GAAa,IAAIxB,GAAGwB,KAAP,CAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,GAAtB,CAAb;AACAH,cAAMI,MAAN,GAAe,YAAf;AACAP,aAAKQ,WAAL,CAAiB,CAAjB,EAAoB,CAAC,GAArB;AACH,KA9CI;;AAgDL;AACAV,mBAAgB,yBAAU;AACtB,YAAIW,OAAO,IAAX;AACA,YAAG3B,GAAG4B,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,kBAA5B,CAAH,EAAmD;AAC/C;AACAH,iBAAKP,YAAL,CAAkBN,MAAlB,GAA2B,KAA3B;AACAa,iBAAKtB,SAAL,CAAeS,MAAf,GAAwB,IAAxB;AACA;AACH;AACD,aAAKiB,SAAL,CAAeJ,IAAf;AACH,KA1DI;;AA4DL;AACAK,iBAAa,uBAAY;AACxBhC,WAAGiC,QAAH,CAAYC,SAAZ,CAAsB,MAAtB;AACA,KA/DI;;AAiEL;AACAC,YAAS,kBAAU;AACf,aAAKC,cAAL;AACApC,WAAGiC,QAAH,CAAYC,SAAZ,CAAsB,MAAtB;AACH,KArEI;;AAuEL;AACAjB,kBAAe,wBAAU;AACrB,YAAG,KAAKP,QAAR,EAAiB;AACb,iBAAK2B,OAAL,GAAerC,GAAGsC,WAAH,CAAeC,IAAf,CAAoB,KAAK7B,QAAzB,EAAmC,IAAnC,EAAyC,GAAzC,CAAf;AACH;AACJ,KA5EI;;AA8EL;AACA0B,oBAAiB,0BAAU;AACnBpC,WAAGsC,WAAH,CAAeE,IAAf,CAAoB,KAAKH,OAAzB;AACP,KAjFI;;AAmFL;AACAN,eAAY,mBAASJ,IAAT,EAAc;AACtB,YAAIc,WAAW,+BAAf;AACA,YAAI9B,MAAMX,GAAGW,GAAH,CAAO+B,GAAP,CAAYD,QAAZ,CAAV;AACAzC,WAAG2C,MAAH,CAAUC,IAAV,CAAgBjC,GAAhB,EAAqB,UAAUkC,GAAV,EAAeC,GAAf,EAAoB;AACrC;AACAnB,iBAAKoB,SAAL,GAAiBD,GAAjB;AACA9C,eAAG4B,GAAH,CAAOC,YAAP,CAAoBmB,OAApB,CAA4B,kBAA5B,EAAgDC,KAAKC,SAAL,CAAevB,KAAKoB,SAApB,CAAhD;AACA;AACApB,iBAAKP,YAAL,CAAkBN,MAAlB,GAA2B,KAA3B;AACAa,iBAAKtB,SAAL,CAAeS,MAAf,GAAwB,IAAxB;AACH,SAPD;AAQH;AA/FI,CAAT","file":"GameStart.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n    \t//开始按钮\r\n    \tbtn_start : {\r\n    \t\tdefault : null,\r\n    \t\ttype : cc.Node\r\n        },\r\n        // 帮助按钮\r\n        btn_help : {\r\n            default : null,\r\n    \t\ttype : cc.Node\r\n        },\r\n        // //总关卡数量\r\n\t\t// number_levels : 8,\r\n    \t// //当前最高关卡\r\n        // highest_level : 1,\r\n        // bgm 音频\r\n        bgmAudio : {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad : function () {\r\n        // waiting\r\n        this.btn_start.active = false;\r\n        this._addWaiting();\r\n\r\n        /* 初始化数据 */\r\n        this._addResources();\r\n        // 音效\r\n        this._onPlayAudio();\r\n    },\r\n\r\n    _addWaiting : function(){\r\n        let node = new cc.Node();\r\n        this.node.addChild(node);\r\n        this.waitingLabel = node;\r\n        let label = node.addComponent(cc.Label);\r\n        node.color = new cc.color(0, 0, 0, 255);\r\n        label.string = 'loading...';\r\n        node.setPosition(0, -150);\r\n    },\r\n\r\n    // 加载玩家初始数据\r\n    _addResources : function(){\r\n        let self = this;\r\n        if(cc.sys.localStorage.getItem('player_resources')){\r\n            // btn\r\n            self.waitingLabel.active = false;\r\n            self.btn_start.active = true;\r\n            return;\r\n        }\r\n        this._initData(self);\r\n    },\r\n\r\n    // 开始游戏 : 开始按钮触发事件\r\n    onStartGame: function () {\r\n    \tcc.director.loadScene(\"menu\");\r\n    },\r\n\r\n    // 帮助\r\n    onHelp : function(){\r\n        this._stopPlayAudio();\r\n        cc.director.loadScene(\"help\");\r\n    },\r\n    \r\n    // 播放音效\r\n    _onPlayAudio : function(){\r\n        if(this.bgmAudio){\r\n            this.current = cc.audioEngine.play(this.bgmAudio, true, 0.3);\r\n        }\r\n    },\r\n\r\n    // 停止音效\r\n    _stopPlayAudio : function(){\r\n            cc.audioEngine.stop(this.current);\r\n    },\r\n\r\n    // 初始化数据\r\n    _initData : function(self){\r\n        let jsonPath = \"resources/json/init_data.json\";\r\n        let url = cc.url.raw( jsonPath);\r\n        cc.loader.load( url, function( err, res) {\r\n            // 加载所有资源\r\n            self.resources = res;\r\n            cc.sys.localStorage.setItem('player_resources', JSON.stringify(self.resources));\r\n            // btn\r\n            self.waitingLabel.active = false;\r\n            self.btn_start.active = true;\r\n        })\r\n    },\r\n});\r\n"]}