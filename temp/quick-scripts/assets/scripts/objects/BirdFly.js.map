{"version":3,"sources":["BirdFly.js"],"names":["BirdObject","require","cc","Class","extends","properties","onLoad","init","fragmentType","onSkill","event","crashFlag","x","getLocationX","y","getLocationY","cameraController","node","parent","getChildByName","getComponent","camera_delta","getPosition","sub","initPosition","location","delta_x","delta_y","delta","Math","hypot","vel_x","emitVelocityMax","vel_y","rotation","atan2","PI","setRotation","setVelocity","start"],"mappings":";;;;;;AACA;;AADA,IAAMA,aAAaC,QAAQ,YAAR,CAAnB;;;AAGAC,GAAGC,KAAH,CAAS;AACLC,aAASJ,UADJ;;AAGLK,gBAAY,EAHP;;AAOLC,YAAS,kBAAY;AACjB,aAAKC,IAAL,CAAU,UAAV;AACA;AACA,aAAKC,YAAL,GAAoB,cAApB;AACH,KAXI;;AAaL;AACAC,aAAU,iBAASC,KAAT,EAAe;AACrB;AACA,YAAG,KAAKC,SAAL,IAAkB,CAACD,KAAtB,EAA4B;AACxB;AACH;AACD;AACA,YAAIE,IAAIF,MAAMG,YAAN,EAAR;AACA,YAAIC,IAAIJ,MAAMK,YAAN,EAAR;AACA;AACA,YAAIC,mBAAmB,KAAKC,IAAL,CAAUC,MAAV,CAAiBA,MAAjB,CAAwBC,cAAxB,CAAuC,QAAvC,EAAiDC,YAAjD,CAA8D,kBAA9D,CAAvB;AACA,YAAIC,eAAeL,iBAAiBC,IAAjB,CAAsBK,WAAtB,GAAoCC,GAApC,CAAwCP,iBAAiBQ,YAAzD,CAAnB;AACA;AACA,YAAIC,WAAW,8BAAiB,KAAKR,IAAtB,CAAf;AACAQ,mBAAWA,SAASF,GAAT,CAAaF,YAAb,CAAX;AACA;AACA;AACA;AACA,YAAIK,UAAUd,IAAIa,SAASb,CAA3B;AACA,YAAIe,UAAUb,IAAIW,SAASX,CAA3B;AACA,YAAIc,QAAQC,KAAKC,KAAL,CAAWJ,OAAX,EAAoBC,OAApB,CAAZ;AACA,YAAII,QAAQ,KAAKC,eAAL,GAAuB,IAAvB,GAA8BN,OAA9B,GAAwCE,KAApD;AACA,YAAIK,QAAQ,KAAKD,eAAL,GAAuB,IAAvB,GAA8BL,OAA9B,GAAwCC,KAApD;AACA;AACA,YAAIM,WAAW,MAAML,KAAKM,KAAL,CAAWF,KAAX,EAAkBF,KAAlB,CAAN,GAAiCF,KAAKO,EAArD;AACA,aAAKnB,IAAL,CAAUoB,WAAV,CAAsBH,QAAtB;AACA;AACA,aAAKI,WAAL,CAAiBP,KAAjB,EAAwBE,KAAxB;AACH,KAzCI;;AA2CLM,SA3CK,mBA2CI,CAER;AA7CI,CAAT","file":"BirdFly.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\objects","sourcesContent":["const BirdObject = require(\"BirdObject\")\r\nimport {getWorldLocation} from '../utils/common';\r\n\r\ncc.Class({\r\n    extends: BirdObject,\r\n\r\n    properties: {\r\n\r\n    },\r\n\r\n    onLoad : function () {\r\n        this.init('bird_fly');\r\n        //碎屑类型\r\n        this.fragmentType = \"FragmentBird\";\r\n    },\r\n\r\n    // 技能\r\n    onSkill : function(event){\r\n        // 碰撞后不生效\r\n        if(this.crashFlag || !event){\r\n            return;\r\n        }\r\n        // 触摸位置\r\n        let x = event.getLocationX();\r\n        let y = event.getLocationY();\r\n        // 相机\r\n        let cameraController = this.node.parent.parent.getChildByName('camera').getComponent('cameraController');\r\n        let camera_delta = cameraController.node.getPosition().sub(cameraController.initPosition);\r\n        // 世界坐标\r\n        let location = getWorldLocation(this.node);\r\n        location = location.sub(camera_delta);\r\n        // 相对于bg的坐标\r\n        // location = location.sub(locationParent);\r\n        // 差\r\n        let delta_x = x - location.x;\r\n        let delta_y = y - location.y;\r\n        let delta = Math.hypot(delta_x, delta_y);\r\n        let vel_x = this.emitVelocityMax * 0.65 * delta_x / delta;\r\n        let vel_y = this.emitVelocityMax * 0.65 * delta_y / delta;\r\n        // 设置旋转方向\r\n        let rotation = 180 * Math.atan2(vel_y, vel_x) / Math.PI;\r\n        this.node.setRotation(rotation);\r\n        // 设置速度\r\n        this.setVelocity(vel_x, vel_y);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n});\r\n"]}